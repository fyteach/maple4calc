<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 3 Derivatives | Notes on Maple for Calculus</title>
  <meta name="description" content="This is a notebook in progress on Maple for Calculus. This notebook was created using bookdown" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 3 Derivatives | Notes on Maple for Calculus" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a notebook in progress on Maple for Calculus. This notebook was created using bookdown" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 3 Derivatives | Notes on Maple for Calculus" />
  
  <meta name="twitter:description" content="This is a notebook in progress on Maple for Calculus. This notebook was created using bookdown" />
  

<meta name="author" content="Fei Ye" />


<meta name="date" content="2019-10-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="limits.html"/>
<link rel="next" href="application-of-differentiation.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes on Maple for Calculus</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="basics-in-maple.html"><a href="basics-in-maple.html"><i class="fa fa-check"></i><b>1</b> Basics in Maple</a><ul>
<li class="chapter" data-level="1.1" data-path="basics-in-maple.html"><a href="basics-in-maple.html#what-should-i-do-after-i-opened-maple"><i class="fa fa-check"></i><b>1.1</b> What should I do after I opened Maple</a></li>
<li class="chapter" data-level="1.2" data-path="basics-in-maple.html"><a href="basics-in-maple.html#basic-operators"><i class="fa fa-check"></i><b>1.2</b> Basic Operators</a></li>
<li class="chapter" data-level="1.3" data-path="basics-in-maple.html"><a href="basics-in-maple.html#how-to-define-a-function"><i class="fa fa-check"></i><b>1.3</b> How to define a function</a></li>
<li class="chapter" data-level="1.4" data-path="basics-in-maple.html"><a href="basics-in-maple.html#initially-known-mathematical-functions"><i class="fa fa-check"></i><b>1.4</b> Initially known mathematical functions</a></li>
<li class="chapter" data-level="1.5" data-path="basics-in-maple.html"><a href="basics-in-maple.html#plot-functions"><i class="fa fa-check"></i><b>1.5</b> Plot functions</a></li>
</ul></li>
<li class="part"><span><b>Part 1 - Calculus I</b></span></li>
<li class="chapter" data-level="2" data-path="limits.html"><a href="limits.html"><i class="fa fa-check"></i><b>2</b> Limits</a><ul>
<li class="chapter" data-level="2.1" data-path="limits.html"><a href="limits.html#understand-limits-using-tangent-lines"><i class="fa fa-check"></i><b>2.1</b> Understand limits using tangent lines</a></li>
<li class="chapter" data-level="2.2" data-path="limits.html"><a href="limits.html#estimate-limits-numerically-or-graphically"><i class="fa fa-check"></i><b>2.2</b> Estimate limits numerically or graphically</a></li>
<li class="chapter" data-level="2.3" data-path="limits.html"><a href="limits.html#evaluate-limits"><i class="fa fa-check"></i><b>2.3</b> Evaluate limits</a></li>
<li class="chapter" data-level="2.4" data-path="limits.html"><a href="limits.html#learn-limit-laws-using-limittutor"><i class="fa fa-check"></i><b>2.4</b> Learn limit laws using <code>LimitTutor</code></a></li>
<li class="chapter" data-level="2.5" data-path="limits.html"><a href="limits.html#squeeze-theorem"><i class="fa fa-check"></i><b>2.5</b> Squeeze Theorem</a></li>
<li class="chapter" data-level="2.6" data-path="limits.html"><a href="limits.html#continuity"><i class="fa fa-check"></i><b>2.6</b> Continuity</a></li>
<li class="chapter" data-level="2.7" data-path="limits.html"><a href="limits.html#continuity-and-limit-of-a-composite-function"><i class="fa fa-check"></i><b>2.7</b> Continuity and Limit of a Composite Function</a></li>
<li class="chapter" data-level="2.8" data-path="limits.html"><a href="limits.html#intermediate-value-theorem"><i class="fa fa-check"></i><b>2.8</b> Intermediate Value Theorem</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="derivatives.html"><a href="derivatives.html"><i class="fa fa-check"></i><b>3</b> Derivatives</a><ul>
<li class="chapter" data-level="3.1" data-path="derivatives.html"><a href="derivatives.html#derivative-functions"><i class="fa fa-check"></i><b>3.1</b> Derivative Functions</a></li>
<li class="chapter" data-level="3.2" data-path="derivatives.html"><a href="derivatives.html#calculating-derivatives"><i class="fa fa-check"></i><b>3.2</b> Calculating Derivatives</a></li>
<li class="chapter" data-level="3.3" data-path="derivatives.html"><a href="derivatives.html#chain-rule"><i class="fa fa-check"></i><b>3.3</b> Chain Rule</a></li>
<li class="chapter" data-level="3.4" data-path="derivatives.html"><a href="derivatives.html#implicit-differentiation"><i class="fa fa-check"></i><b>3.4</b> Implicit Differentiation</a></li>
<li class="chapter" data-level="3.5" data-path="derivatives.html"><a href="derivatives.html#rates-of-change-and-derivatives"><i class="fa fa-check"></i><b>3.5</b> Rates of Change and Derivatives</a></li>
<li class="chapter" data-level="3.6" data-path="derivatives.html"><a href="derivatives.html#related-rates"><i class="fa fa-check"></i><b>3.6</b> Related Rates</a></li>
<li class="chapter" data-level="3.7" data-path="derivatives.html"><a href="derivatives.html#linearizations"><i class="fa fa-check"></i><b>3.7</b> Linearizations</a></li>
<li class="chapter" data-level="3.8" data-path="derivatives.html"><a href="derivatives.html#newtons-method"><i class="fa fa-check"></i><b>3.8</b> Newton’s Method</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="application-of-differentiation.html"><a href="application-of-differentiation.html"><i class="fa fa-check"></i><b>4</b> Application of Differentiation</a><ul>
<li class="chapter" data-level="4.1" data-path="application-of-differentiation.html"><a href="application-of-differentiation.html#maximum-and-minimum-values"><i class="fa fa-check"></i><b>4.1</b> Maximum and Minimum Values</a></li>
<li class="chapter" data-level="4.2" data-path="application-of-differentiation.html"><a href="application-of-differentiation.html#the-mean-value-theorem"><i class="fa fa-check"></i><b>4.2</b> The Mean Value Theorem</a></li>
<li class="chapter" data-level="4.3" data-path="application-of-differentiation.html"><a href="application-of-differentiation.html#derivatives-and-the-shape-of-a-graph"><i class="fa fa-check"></i><b>4.3</b> Derivatives and the Shape of a Graph</a></li>
<li class="chapter" data-level="4.4" data-path="application-of-differentiation.html"><a href="application-of-differentiation.html#limits-at-infinity-and-asymptotes"><i class="fa fa-check"></i><b>4.4</b> Limits at Infinity and Asymptotes</a></li>
<li class="chapter" data-level="4.5" data-path="application-of-differentiation.html"><a href="application-of-differentiation.html#curve-sketching"><i class="fa fa-check"></i><b>4.5</b> Curve Sketching</a></li>
<li class="chapter" data-level="4.6" data-path="application-of-differentiation.html"><a href="application-of-differentiation.html#optimization-problems"><i class="fa fa-check"></i><b>4.6</b> Optimization Problems</a></li>
<li class="chapter" data-level="4.7" data-path="application-of-differentiation.html"><a href="application-of-differentiation.html#antiderivatives"><i class="fa fa-check"></i><b>4.7</b> Antiderivatives</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="integrals.html"><a href="integrals.html"><i class="fa fa-check"></i><b>5</b> Integrals</a><ul>
<li class="chapter" data-level="5.1" data-path="integrals.html"><a href="integrals.html#definite-integrals"><i class="fa fa-check"></i><b>5.1</b> Definite Integrals</a></li>
<li class="chapter" data-level="5.2" data-path="integrals.html"><a href="integrals.html#the-fundamental-theorem-of-calculus"><i class="fa fa-check"></i><b>5.2</b> The Fundamental Theorem of Calculus</a></li>
<li class="chapter" data-level="5.3" data-path="integrals.html"><a href="integrals.html#indefinite-integrals"><i class="fa fa-check"></i><b>5.3</b> Indefinite Integrals</a></li>
<li class="chapter" data-level="5.4" data-path="integrals.html"><a href="integrals.html#the-substitution-rule"><i class="fa fa-check"></i><b>5.4</b> The Substitution Rule</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="application-of-integrals-i.html"><a href="application-of-integrals-i.html"><i class="fa fa-check"></i><b>6</b> Application of Integrals I</a><ul>
<li class="chapter" data-level="6.1" data-path="application-of-integrals-i.html"><a href="application-of-integrals-i.html#areas-between-curves"><i class="fa fa-check"></i><b>6.1</b> Areas Between Curves</a></li>
</ul></li>
<li class="part"><span><b>Part 2 - Calculus II</b></span></li>
<li class="chapter" data-level="7" data-path="applications-of-integrals-ii.html"><a href="applications-of-integrals-ii.html"><i class="fa fa-check"></i><b>7</b> Applications of Integrals II</a><ul>
<li class="chapter" data-level="7.1" data-path="applications-of-integrals-ii.html"><a href="applications-of-integrals-ii.html#volume-of-revolution"><i class="fa fa-check"></i><b>7.1</b> Volume of Revolution</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="calculus-of-inverse-functions.html"><a href="calculus-of-inverse-functions.html"><i class="fa fa-check"></i><b>8</b> Calculus of Inverse Functions</a><ul>
<li class="chapter" data-level="8.1" data-path="calculus-of-inverse-functions.html"><a href="calculus-of-inverse-functions.html#inverse-functions"><i class="fa fa-check"></i><b>8.1</b> Inverse Functions</a></li>
<li class="chapter" data-level="8.2" data-path="calculus-of-inverse-functions.html"><a href="calculus-of-inverse-functions.html#logarithmic-and-exponential-functions"><i class="fa fa-check"></i><b>8.2</b> Logarithmic and Exponential Functions</a><ul>
<li class="chapter" data-level="8.2.1" data-path="calculus-of-inverse-functions.html"><a href="calculus-of-inverse-functions.html#basic-properties-and-graphs"><i class="fa fa-check"></i><b>8.2.1</b> Basic properties and graphs</a></li>
<li class="chapter" data-level="8.2.2" data-path="calculus-of-inverse-functions.html"><a href="calculus-of-inverse-functions.html#differentiation-and-integration-of-logarithmic-and-exponential-functions"><i class="fa fa-check"></i><b>8.2.2</b> Differentiation and integration of logarithmic and exponential functions</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="calculus-of-inverse-functions.html"><a href="calculus-of-inverse-functions.html#solve-differential-equations"><i class="fa fa-check"></i><b>8.3</b> Solve differential equations</a></li>
<li class="chapter" data-level="8.4" data-path="calculus-of-inverse-functions.html"><a href="calculus-of-inverse-functions.html#inverse-trigonometric-functions"><i class="fa fa-check"></i><b>8.4</b> Inverse Trigonometric Functions</a><ul>
<li class="chapter" data-level="8.4.1" data-path="calculus-of-inverse-functions.html"><a href="calculus-of-inverse-functions.html#domains-and-ranges"><i class="fa fa-check"></i><b>8.4.1</b> Domains and Ranges</a></li>
<li class="chapter" data-level="8.4.2" data-path="calculus-of-inverse-functions.html"><a href="calculus-of-inverse-functions.html#differentiation-and-integration-of-inverse-trigonometric-functions"><i class="fa fa-check"></i><b>8.4.2</b> Differentiation and integration of inverse trigonometric functions</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="calculus-of-inverse-functions.html"><a href="calculus-of-inverse-functions.html#lhospitals-rule"><i class="fa fa-check"></i><b>8.5</b> L’Hospital’s Rule</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="techniques-of-integration.html"><a href="techniques-of-integration.html"><i class="fa fa-check"></i><b>9</b> Techniques of Integration</a><ul>
<li class="chapter" data-level="9.1" data-path="techniques-of-integration.html"><a href="techniques-of-integration.html#integrations-of-trigonometric-functions"><i class="fa fa-check"></i><b>9.1</b> Integrations of trigonometric functions</a></li>
<li class="chapter" data-level="9.2" data-path="techniques-of-integration.html"><a href="techniques-of-integration.html#trigonometric-substitution"><i class="fa fa-check"></i><b>9.2</b> Trigonometric Substitution</a></li>
<li class="chapter" data-level="9.3" data-path="techniques-of-integration.html"><a href="techniques-of-integration.html#integrations-of-rational-functions-by-partial-fractions"><i class="fa fa-check"></i><b>9.3</b> Integrations of Rational Functions by Partial Fractions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="further-applications-of-integration.html"><a href="further-applications-of-integration.html"><i class="fa fa-check"></i><b>10</b> Further Applications of Integration</a><ul>
<li class="chapter" data-level="10.1" data-path="further-applications-of-integration.html"><a href="further-applications-of-integration.html#arc-lengths-and-areas-of-surfaces-of-revolutions"><i class="fa fa-check"></i><b>10.1</b> Arc Lengths and Areas of Surfaces of Revolutions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="infinite-sequences-and-series.html"><a href="infinite-sequences-and-series.html"><i class="fa fa-check"></i><b>11</b> Infinite Sequences and Series</a><ul>
<li class="chapter" data-level="11.1" data-path="infinite-sequences-and-series.html"><a href="infinite-sequences-and-series.html#introduction-to-sequences-and-series"><i class="fa fa-check"></i><b>11.1</b> Introduction to Sequences and Series</a></li>
<li class="chapter" data-level="11.2" data-path="infinite-sequences-and-series.html"><a href="infinite-sequences-and-series.html#power-series"><i class="fa fa-check"></i><b>11.2</b> Power Series</a></li>
<li class="chapter" data-level="11.3" data-path="infinite-sequences-and-series.html"><a href="infinite-sequences-and-series.html#taylor-expansion"><i class="fa fa-check"></i><b>11.3</b> Taylor Expansion</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes on Maple for Calculus</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="derivatives" class="section level1">
<h1><span class="header-section-number">Topic 3</span> Derivatives</h1>
<div id="derivative-functions" class="section level2">
<h2><span class="header-section-number">3.1</span> Derivative Functions</h2>
<p>What makes derivative so important in modern mathematics is the ideal of linearly approximating curves using tangent lines. Geometrically, the derivative of a function <span class="math inline">\(f\)</span> at a point <span class="math inline">\(x=a\)</span> is the slope of the line tangent to <span class="math inline">\(f\)</span> at <span class="math inline">\(x=a\)</span>. Using limits (if it exists), the derivative is defined as
<span class="math display">\[
f&#39;(a):=\lim\limits_{x\to a}\frac{f(x)-f(a)}{x-a}.
\]</span></p>
<p>Consider <span class="math inline">\(a\)</span> as a variable, we may define a function called the derivative function. In terms of limits, the derivative function of a function <span class="math inline">\(f\)</span>, denoted by <span class="math inline">\(f&#39;\)</span> is given by
<span class="math display">\[
f&#39;(x)=\lim\limits_{h\to 0}\frac{f(x+h)-f(x)}{h}.
\]</span></p>
<p>Using limit laws, we can show that differentiable functions are continuous.</p>
<p>Geometrically, the graph of differentiable function locally is flat without any hole or jump.</p>
<p>All <a href="https://en.wikipedia.org/wiki/Elementary_function">elementary functions</a> are differentiable over their domain. But there are also many functions which are not differential everywhere in their domain.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-44" class="example"><strong>Example 3.1  </strong></span>
Use the graph of the function <span class="math inline">\(f(x)=|x-1|\)</span> to identify a <span class="math inline">\(x\)</span> value where <span class="math inline">\(f\)</span> is not differential. Verify your finding using the definition of differentiability.</p>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> 
First plot the function.</p>
<pre><code>f:= x-&gt; abs(x)

plot(f(x), x=-2..2)</code></pre>
<p>You will see the function is not flat near <span class="math inline">\(x=1\)</span>. To verify that, we calculate the limit of the difference quotient for all <span class="math inline">\(x\)</span> and then evaluate the resulting function at <span class="math inline">\(x=1\)</span>.</p>
<pre><code>diffquot:=(f(x+h)-f(x))/h

derlimit:= limit(diffquot, h=0)

evalf(subs(x=1, derlimit))</code></pre>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-46" class="exercise"><strong>Exercise 3.1  </strong></span>
Determine whether the function
<span class="math display">\[
f(x)=\begin{cases}
x\sin\left(\frac1x\right) &amp; x\neq 0\\
0 &amp; x=0
\end{cases}
\]</span>
is differential at <span class="math inline">\(x=0\)</span> using the definition of the differentiability.</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-47" class="exercise"><strong>Exercise 3.2  </strong></span>
Determine whether the function
<span class="math display">\[
f(x)=\begin{cases}
x^2\cos\left(\frac1x\right) &amp; x\neq 0\\
0 &amp; x=0
\end{cases}
\]</span>
is differential at <span class="math inline">\(x=0\)</span> using the definition of the differentiability.</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-48" class="exercise"><strong>Exercise 3.3  </strong></span>
Using the definition to find the derivative for <span class="math inline">\(y=\sin x\)</span>.</p>
</div>

</div>
<div id="calculating-derivatives" class="section level2">
<h2><span class="header-section-number">3.2</span> Calculating Derivatives</h2>
<p>Calculating a derivative in Maple is as easy as calculating a limit. The command for differentiation is <code>diff(function, variable)</code>. For higher derivatives, you may simply repeat the variable or use <code>[variable$n]</code> to indicate the <span class="math inline">\(n\)</span> times differentiation.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-49" class="example"><strong>Example 3.2  </strong></span>
Calculate the first derivative and the second derivative for the function
<span class="math display">\[
f(x)=\frac{2}{\sqrt{2\sin^2 x + 1}}.
\]</span></p>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> 
First represent the function rule simply by <code>f</code>.</p>
<pre><code>f:=2/(sqrt(2*(sin(x))^2+1))</code></pre>
<p>Calculate the first derivative and denote the derivative by <code>f1</code>.</p>
<pre><code>f1:=diff(f, x);</code></pre>
<p>Calculate the second derivative and denote the derivative by <code>f2</code>. You may use one of the following three commands.</p>
<pre><code>f2:=diff(f1, x)
f2:=diff(f, x, x)
f2:=diff(f, [x$2])</code></pre>
</div>

<p>Maple also has a tutoring command for differentiation: <code>DiffTutor(function, variable)</code> which is again supported by the subpackage <code>Student[Calculus1]</code>. However, <code>DiffTutor</code> only works for the first derivative.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-51" class="example"><strong>Example 3.3  </strong></span>
Calculate the derivative for <span class="math inline">\(g(x)=\frac{x^2-2x-x^{-3}}{\sqrt{x}}\)</span> by hand and compare your calculation the the result given by <code>DiffTutor</code>.</p>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> 
By hand, we may simplify the expression using rational exponents first and then apply derivative rules.
<span class="math display">\[
g&#39;(x)=(x^{\frac32}-2x^{\frac12}-x^{-\frac72})&#39;=\frac32\sqrt{x}-\frac{1}{\sqrt{x}}+\frac{7}{2x^4\sqrt{x}}=\frac{3x^5-2x^4+7}{2x^4\sqrt{x}}.
\]</span></p>
<p>To see the result from <code>DiffTutor</code>, we use the following command. Remember to load the <code>Student[Calculus1]</code> first.</p>
<pre><code>with(Student[Calculus1])
DiffTutor((x^2-2*x-x^(-3))/sqrt(x), x)</code></pre>
<p>Here is how does the output look like</p>
<div class="figure">
<img src="figs/DiffTutor-Example.png" alt="" />
<p class="caption">The derivative of a function obtained by the DiffTutor command</p>
</div>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-53" class="exercise"><strong>Exercise 3.4  </strong></span>
Calculate the first derivative for the function <span class="math inline">\(y=2x^{-1}-3\sqrt{x}\)</span> by hand and by Maple. Compare two results. Are they different? If so, can you explain the difference?</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-54" class="exercise"><strong>Exercise 3.5  </strong></span>
Calculate the first derivative for the function <span class="math inline">\(y=x\sin^{-1}(x)\)</span> by hand and by Maple. Compare two results. Are they different? If so, can you explain the difference?</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-55" class="exercise"><strong>Exercise 3.6  </strong></span>
Calculate the first derivative for the function <span class="math inline">\(y=\frac{\cos(x)+\sin x}{x}\)</span> by hand and by Maple. Compare two results. Are they different? If so, can you explain the difference?</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-56" class="exercise"><strong>Exercise 3.7  </strong></span>
Calculate the <span class="math inline">\(3\)</span>-th derivative for the function <span class="math inline">\(y=\sin x\cos x\)</span> by hand and by Maple. Can you find a formula for the <span class="math inline">\(n\)</span>-th derivative of the function?</p>
</div>

</div>
<div id="chain-rule" class="section level2">
<h2><span class="header-section-number">3.3</span> Chain Rule</h2>
<p>Let <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(g(x)\)</span> be two differentiable functions. Then the derivative of the composite function <span class="math inline">\(f(g(x))\)</span> can be calculated using the following formula
<span class="math display">\[
(f(g(x)))&#39;=f&#39;(g(x))g&#39;(x).
\]</span>
Why there is an extra factor <span class="math inline">\(g&#39;(x)\)</span>? This is mainly because <span class="math inline">\(g(x+h)\approx g(x)+g&#39;(x)h\)</span>.
<!-- More precisely, let
$$
\varepsilon(y, t)=\frac{f(y+t)-f(y)}{t}-f'(y).
$$
Then $f(y+t)-f(y)=t(f'(y)-\varepsilon(y, t)$, $\varepsilon(y, t)$ is a continuous function in $t$ for each fixed value $y$, and $lim\limits_{t\to 0}\varepsilon(y, t)=0$ for every fixed $y$.
Now let $y=g(x)$ and $t=g(x+h)-g(x)$. Then
$$
\lim_{h\to 0}\frac{f(g(x+h))-f(x)}{h}=\lim_{h\to 0}\frac{g(x+h)-g(x)}{h}(f'(g(x))-\lim_{h\to 0}\varepsilon(g(x), (g(x+h)-g(x)))=f'(g(x))g'(x).
$$ --></p>
<p>Now let’s use Maple to understand the chain rule. In Maple, the symbol for composition is <code>@</code>, that is, in Maple the composition <span class="math inline">\(f\circ g\)</span> is given by <code>f@g</code>.</p>
<p>Since we will evaluate derivative functions, in addition to the command <code>diff(expression, variable)</code>, we will also use <code>D(function)(variable)</code> to find the derivative function. One major difference between those two commands is that <code>D</code> is designed to differentiate functions, whereas <code>diff</code> is for differentiating expressions.</p>
<div class="figure">
<img src="figs/D_vs_diff.png" alt="" />
<p class="caption">A screen shot from Maple shows a comparison between the commands D and diff</p>
</div>

<div class="example">
<p><span id="exm:unnamed-chunk-57" class="example"><strong>Example 3.4  </strong></span>
Let <span class="math inline">\(f(x)=\sin x\)</span>, <span class="math inline">\(g(x)=2x\)</span> and <span class="math inline">\(F(x)=2\sin x\cos x\)</span>. Find <span class="math inline">\(f&#39;(g(x))\)</span>, <span class="math inline">\((fg)&#39;(x)\)</span>, <span class="math inline">\((f\circ g)&#39;(x)\)</span> and <span class="math inline">\(F&#39;(x)\)</span>?
Compare the derivatives and draw a conclusion.</p>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> 
We first define the functions.</p>
<pre><code>f:=x-&gt;sin(x);
g:=x-&gt;2*x;
F:=x-&gt;2*sin(x)*cos(x);</code></pre>
<p>Find the derivative functions</p>
<pre><code>Der_f_g:=D(f)(g(x)); # f&#39;(g(x))
Der_fg:=diff(f(x)g(x), x); # (fg)&#39;(x)
Der_fog:=D(f@g)(x); # (fog)&#39;(x)
Der_F:=D(F)(x); # F&#39;(x)</code></pre>
<p>To compare the derivatives, we use the command <code>expand</code> and <code>simplify</code> to rewrite the expressions.</p>
<pre><code>simplify(expand(Der_f_g));
simplify(expand(Der_fg));
simplify(expand(Der_fog));
simplify(expand(Der_F));</code></pre>
<p>From the outputs, we see that <span class="math inline">\((f\circ g)&#39;(x)=F&#39;(x)\)</span>. Why they are the same? This is because <span class="math inline">\(\sin(2x)=2\sin x\cos x\)</span>!.</p>
<div class="figure">
<img src="figs/chain_rule.png" alt="" />
<p class="caption">An example about the chain rule solved using Maple</p>
</div>
</div>


<div class="remark">
<p> <span class="remark"><em>Remark. </em></span> 
You may also use <code>D(unapply(f(x)*g(x), x))(x)</code> to calculate the derivative of the product function <span class="math inline">\((fg)(x)=f(x)g(x)\)</span>.</p>
</div>

<p>The chain rule is almost unavoidable in calculation of derivatives. Sometimes, using chain rule will simplify the calculation.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-60" class="example"><strong>Example 3.5  </strong></span>
Consider the function <span class="math inline">\(f(x)=\frac{1}{\sin x+\cos x}\)</span>.</p>
<ol style="list-style-type: decimal">
<li>Find the derivative function <span class="math inline">\(f&#39;(x)\)</span> using <code>DiffTutor</code>. Which rule of derivative was applied first?</li>
<li>Find the point where the tangent line of <span class="math inline">\(f\)</span> is horizontal over the domain <span class="math inline">\((-\frac{\pi}{2}, \frac{\pi}{2})\)</span>.</li>
<li>Find an equation of the tangent line at <span class="math inline">\((0, 1)\)</span>.</li>
<li>Plot the tangent line and the function together over the domain <span class="math inline">\((-\frac12, \frac12)\)</span>.</li>
</ol>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> 
You may use quotient rule to find the derivative. However, the chain rule may be a better choice because <span class="math inline">\(\frac{1}{\sin x+\cos x}=(\sin x+\cos x)^{-1}\)</span>. Let’s try <code>DiffTutor</code>.</p>
<pre><code>restart; # Use `restart` to clear the internal memory.
with(Student[Calculus1]);
f:=1/(sin(x)+cos(x));
DiffTutor(f, x);</code></pre>
<p>You see that the chain rule was applied first.</p>
<div class="figure">
<img src="figs/DiffTutor-Chain-Rule-Example.png" alt="" />
<p class="caption">A example that chain rule was applied first by DiffTutor</p>
</div>
<p>To find the points where the tangent line is horizontal, we need to solve the equation <span class="math inline">\(f&#39;(x)=0\)</span>.</p>
<pre><code>solve(diff(f, x)=0)</code></pre>
<p>To find the tangent line, we find the derivative <span class="math inline">\(f&#39;(0)\)</span>. One way is to use <code>unapply</code>.</p>
<pre><code>unapply(diff(f, x), x)(0)</code></pre>
<p>You may also use <code>eval(expression, variable=value)</code>.</p>
<pre><code>eval(diff(f, x), x=0)</code></pre>
<p>Since <span class="math inline">\(f&#39;(0)=-1\)</span>, the tangent line at <span class="math inline">\((0, 1)\)</span> is defined by <span class="math inline">\(y=-x+1\)</span>.</p>
<pre><code>y:= -x+1</code></pre>
<p>Now let’s verify visually that <span class="math inline">\(y=-x+1\)</span> is the tangent line.</p>
<pre><code>plot([f, y], x=-1/2..1/2)</code></pre>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-62" class="exercise"><strong>Exercise 3.8  </strong></span>
Let <span class="math inline">\(f(x)=\sin x\)</span>, <span class="math inline">\(g(x)=\frac{\pi}{2}-x\)</span> and <span class="math inline">\(h(x)=\cos x\)</span>. Find <span class="math inline">\(f&#39;(g(x))\)</span>, <span class="math inline">\((fg)&#39;(x)\)</span>, <span class="math inline">\((f\circ g)&#39;(x)\)</span> and <span class="math inline">\(h&#39;(x)\)</span>. Compare the derivatives and draw a conclusion.</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-63" class="exercise"><strong>Exercise 3.9  </strong></span>
Let <span class="math inline">\(f(x)=x^2\)</span> and <span class="math inline">\(g(x)=\cos x\)</span> and <span class="math inline">\(h(x)=\frac{1}{2}(\cos(2x)+1)\)</span>. Find <span class="math inline">\(f&#39;(g(x))\)</span>, <span class="math inline">\((fg)&#39;(x)\)</span>, <span class="math inline">\((f\circ g)&#39;(x)\)</span> and <span class="math inline">\(h&#39;(x)\)</span>. Compare the derivatives and draw a conclusion.</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-64" class="exercise"><strong>Exercise 3.10  </strong></span>
Consider the function <span class="math inline">\(F(x)=\sin^2(\frac{\pi(x^2+1)}{3})\)</span>.</p>
<ol style="list-style-type: decimal">
<li>Define three functions <span class="math inline">\(f\)</span>, <span class="math inline">\(g\)</span> and <span class="math inline">\(h\)</span> so that <span class="math inline">\(F(x)=f(g(h(x)))\)</span>.</li>
<li>Describe how the derivative function <span class="math inline">\(F&#39;(x)\)</span> was calculated by <code>DiffTutor</code>.</li>
<li>Find the point where the tangent line of <span class="math inline">\(F\)</span> is horizontal over the domain <span class="math inline">\((0, 1)\)</span>.</li>
<li>Find an equation of the tangent line of <span class="math inline">\(F\)</span> at <span class="math inline">\((1, \frac34)\)</span>.</li>
<li>Plot the tangent line and the function together over the domain <span class="math inline">\((\frac12, \frac32)\)</span>.</li>
</ol>
</div>

</div>
<div id="implicit-differentiation" class="section level2">
<h2><span class="header-section-number">3.4</span> Implicit Differentiation</h2>
<p>Implicit differentiation is an application of the chain rule. It provides a way to find the slope of a tangent line of a function implicitly defined by an equation, that is, the dependent variable is not isolated.</p>
<p>In Maple, there are two useful commands that help us understand implicit defined functions.
The command <code>implicitplot(equation, domain, range, options)</code> supported by the package <code>plots</code> can be used to graph an implicitly defined function.
The command <code>implicitdiff(function, dependent variable, independent variable)</code> can be used to find derivatives implicitly.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-65" class="example"><strong>Example 3.6  </strong></span>
Graph the function <span class="math inline">\(y\)</span> of <span class="math inline">\(x\)</span> defined by <span class="math inline">\(x^2+2y^2=2x+4y\)</span> with it tangent line at <span class="math inline">\((2, 0)\)</span> over the domain <span class="math inline">\((1, 3)\)</span> and range <span class="math inline">\((-1, 2)\)</span>.</p>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> 
Let’s first assign an name to the equation. (Run <code>restart</code> first if <code>x</code> and <code>y</code> were previously used an names.)</p>
<pre><code>restart;
eqnf:=x^2+2*y^2=2*x+4*y;</code></pre>
<p>Now let’s find the derivative function, and its value at <span class="math inline">\((0, 1)\)</span>.</p>
<pre><code>D_eqnf:=implicitdiff(eqnf, y, x);
slope:=eval(D_eqnf, {x=2, y=0});</code></pre>
<p>Let’s define the tangent line</p>
<pre><code>tangentline:= y=slope*(x-2)+0</code></pre>
<p>Now we are ready to plot the function with the tangent line together.</p>
<pre><code>with(plots);
implicitplot([eqnf, tangentline], x=1..3, y=-1..2, color=[red, blue]);</code></pre>
</div>


<div class="remark">
<p> <span class="remark"><em>Remark. </em></span> 
Another way, which is more flexible, to put two or more graphs together is to use the command <code>display(graph1, graph2)</code> which is supported by the package <code>plots</code>. For example, the following commands will show two curves in a single picture.</p>
<pre><code>with(plots):
g1 := implicitplot(x^2+y^2=1, x=-1..1, y=0..1):
g2 := plot(1-abs(x), x=-1..1):
display(g1, g2, title=&quot;Two Together&quot;);</code></pre>
<p>Note that we use colone <code>:</code> at the end of a command to hide the output.</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-68" class="exercise"><strong>Exercise 3.11  </strong></span>
For the ellipse <span class="math inline">\(x^2-xy+y^2=4\)</span>, find the locations of all horizontal tangent lines and plot them implicitly on the same graph as the relation over the interval <span class="math inline">\(-3 \leq x \leq 3\)</span> and <span class="math inline">\(-3 \leq y \leq 3\)</span>.</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-69" class="exercise"><strong>Exercise 3.12  </strong></span>
Find an equation of the line tangent to the curve <span class="math inline">\(x^2 + (x-y)^3 = 9\)</span> at <span class="math inline">\(x=1\)</span>. (You may want to use <code>solve</code> and <code>subs</code> to find the <span class="math inline">\(y\)</span> when <span class="math inline">\(x=1\)</span>).</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-70" class="exercise"><strong>Exercise 3.13  </strong></span>
Find all points <span class="math inline">\((x, y)\)</span> on the curve of <span class="math inline">\(|x|^{2/3} + |y|^{2/3} = 8\)</span> where lines tangent to the curve at <span class="math inline">\((x, y)\)</span> is perpendicular to the line <span class="math inline">\(x-y=1\)</span>. (Use <code>?solve</code> to learn how to solve a system of equations in Maple).</p>
</div>

</div>
<div id="rates-of-change-and-derivatives" class="section level2">
<h2><span class="header-section-number">3.5</span> Rates of Change and Derivatives</h2>
<p>Given a function <span class="math inline">\(y=f(x)\)</span>, the average rate of change of <span class="math inline">\(f\)</span> is the difference quotient
<span class="math display">\[
\frac{\Delta y}{\Delta x}=\frac{f(x+\Delta x)-f(x)}{\Delta x}.
\]</span>
The instantaneous rate of change is the limit <span class="math inline">\(\lim\limits_{\Delta x\to 0}\frac{\Delta y}{\Delta x}\)</span> which is exactly the derivate of <span class="math inline">\(f\)</span>. However, in science, economy and many other field, the same concept bears different names. For example, the velocity is the instantaneous rate of change of the position function; the marginal cost is the derivative of the cost function.</p>
<p>Now let’s use Maple to help us understand such kind of application of derivatives.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-71" class="example"><strong>Example 3.7  </strong></span>
The position function of a particle moving along a straight line after <span class="math inline">\(t\)</span> seconds is <span class="math inline">\(s(t)= 2t^3-6t^2-18t+1\)</span> meters.</p>
<ol style="list-style-type: decimal">
<li>Find the time <span class="math inline">\(t\)</span> that the particle is at the rest.</li>
<li>Find the distance the particle moved in the first 5 seconds.</li>
<li>Plot the <span class="math inline">\(s(t)\)</span>, <span class="math inline">\(v(t)\)</span> and <span class="math inline">\(a(t)\)</span> for <span class="math inline">\(0\le t\le 5\)</span> together.</li>
<li>When the particle is speeding up?</li>
<li>Confirm you answer in 3. using graph of the speed function.</li>
</ol>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> 
Let’s first define if position function</p>
<pre><code>s:= t-&gt;2*t^3-6*t^2-18*t+1</code></pre>
<p>The particle at rest when the velocity is 0. To find <span class="math inline">\(t\)</span>, we find <span class="math inline">\(v(t)\)</span> first and then solve <span class="math inline">\(t\)</span> from <span class="math inline">\(v(t)=0\)</span>.</p>
<pre><code>v:=D(s);
solve({v(t)=0, t&gt;0}, t); # assuming t&gt;0.</code></pre>
<p>From the output, you will find that after 3 second the particle is temporarily at rest.</p>
<p>The particle moves forward if <span class="math inline">\(v(t)&gt;0\)</span> and backward if <span class="math inline">\(v(t)&lt;0\)</span>. You may use the previous output or apply the command <code>solve</code> for those two inequalities. Either way, you will find from <span class="math inline">\(t=0\)</span> to <span class="math inline">\(t=3\)</span>, <span class="math inline">\(v(t)&lt;0\)</span> and <span class="math inline">\(v(t)&gt;0\)</span> for <span class="math inline">\(3&lt;t\le 5\)</span>. So the total distance should be calculated as</p>
<pre><code>totdist:= abs(s(3)-s(0))+abs(s(5)-s(3))</code></pre>
<p>The acceleration function <span class="math inline">\(a(t)=v&#39;(t)\)</span>. To plot those three functions together, you may use <code>plot</code>.</p>
<pre><code>a:=D(v);
plot([s(t), v(t), a(t)], t=0..5, color=[black, blue, red]);</code></pre>
<p>The speed function of the particle is <span class="math inline">\(|v(t)|\)</span>. When <span class="math inline">\(v(t)&gt;0\)</span> and <span class="math inline">\(a(t)&gt;0\)</span>, the particle is speeding up. When <span class="math inline">\(v(t)&lt;0\)</span> and <span class="math inline">\(a(t)&lt;0\)</span>, the particle is also speeding up. So the particle is speeding up if <span class="math inline">\(v(t)a(t)&gt;0\)</span>. Similarly, the particle is slowing down if <span class="math inline">\(v(t)a(t)&lt;0\)</span>.</p>
<pre><code> solve({v(t)*a(t)&gt;0, t&gt;0}, t)</code></pre>
<p>It shows that the particle is speeding up when <span class="math inline">\(t&lt;1\)</span> or <span class="math inline">\(t&gt;3\)</span>. This can also be seen from the graph of the speed function.</p>
<pre><code> plot(abs(v(t)), t=0..5)</code></pre>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-73" class="exercise"><strong>Exercise 3.14  </strong></span>
The position function of a particle moving along a straight line after <span class="math inline">\(t\)</span> seconds is <span class="math inline">\(s(t) = t^3 - 6t^2 - 15t+2\)</span> meters.</p>
<ol style="list-style-type: decimal">
<li>Find the time <span class="math inline">\(t\)</span> that the particle is at the rest.</li>
<li>Find the distance the particle moved in the first 5 seconds.</li>
<li>Plot the <span class="math inline">\(s(t)\)</span>, <span class="math inline">\(v(t)\)</span> and <span class="math inline">\(a(t)\)</span> for <span class="math inline">\(0\le t\le 5\)</span> together.</li>
<li>When the particle is speeding up?</li>
<li>Confirm you answer in 3. using graph of the speed function.</li>
</ol>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-74" class="exercise"><strong>Exercise 3.15  </strong></span>
Suppose that the profit obtained from the sale of <span class="math inline">\(x\)</span> calculators is given by <span class="math inline">\(P(x)=-0.05x^2+4x+25\)</span>. Use the marginal profit function to estimate the profit from the sale of the 51st calculator.</p>
</div>

</div>
<div id="related-rates" class="section level2">
<h2><span class="header-section-number">3.6</span> Related Rates</h2>
<p>Stewart suggests the following general steps for solving problems about related rates.</p>
<ol style="list-style-type: decimal">
<li>Read the problem carefully. (What quantities are known? What is the unknown rate of change?)</li>
<li>Draw a diagram if possible.</li>
<li>Introduce notations. Assign symbols to all quantities that are functions of time.</li>
<li>Express the given information and the required rate in terms of derivatives.</li>
<li>Write an equation that relates the various quantities of the problem. If necessary, use the geometry of the situation to eliminate one of the variables by substitution.</li>
<li>Use the Chain Rule to differentiate both sides of the equation with respect to the shared independent variable, say <span class="math inline">\(t\)</span>.</li>
<li>Substitute the given information into the resulting equation and solve for the unknown rate.</li>
</ol>
<p>In Maple, the quantities that shared by the same independent variable should be written in function notations. See the following example for details.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-75" class="example"><strong>Example 3.8  </strong></span>
A spherical shaped balloon is inflated at a constant rate 2 cm<span class="math inline">\(^3\)</span>/s. Find the relative rate growth of the diameter when its 10 cm wide.</p>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> 
The volume of a sphere is given by <span class="math inline">\(V=\frac{4\pi}{3}r^3\)</span>. In this equation, both <span class="math inline">\(V\)</span> and <span class="math inline">\(r\)</span> are functions of the time <span class="math inline">\(t\)</span>. In Maple, we will use <code>V(t)</code> and <code>r(t)</code> for the volume and the radius.</p>
<pre><code>eqn_v:=V(t)=4*Pi/3*(r(t))^3</code></pre>
<p>We know that at a certain time <span class="math inline">\(r(t)=10/2=5\)</span>, and <span class="math inline">\(\frac{\mathrm{d}}{\mathrm{d} t}V(t)|_{r(t)=5}=2\)</span>. What is asked is <span class="math inline">\(\frac{\mathrm{d}}{\mathrm{d} t}r(t)|_{r(t)=5}\)</span>. The two rates are related by the equation obtained by differentiating both side of the equation <code>eqn_v</code>.</p>
<pre><code>D_eqn_v:=diff(eqn_v, t)</code></pre>
<p>In the above equation, we need to solve the derivative of <span class="math inline">\(r\)</span> with respect to <span class="math inline">\(t\)</span>. Let’s first simplify notations.</p>
<pre><code>D_v:=diff(V(t), t);
D_r:=diff(r(t), t);
D_r:=solve(D_eqn_v, D_r);</code></pre>
<p>Now we plugin <code>D_v=2</code> and <code>r(t)=5</code> to find the value for <code>D_r</code>.</p>
<pre><code>subs({D_v=2, r(t)=5}, D_r) # or using eval(D_r, {D_v=2, r(t)=5})</code></pre>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-77" class="exercise"><strong>Exercise 3.16  </strong></span>
A cylindrical cup with radius 5 cm is being filled with coffee at a rate of 2 cm<span class="math inline">\(^3\)</span>/s. How fast is
the height of the coffee increasing?</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-78" class="exercise"><strong>Exercise 3.17  </strong></span>
Two cars start moving from the same point. One travels north at 30 mph and the other travels
west at 50 mph. At what rate is the distance between the cars changing one hour later?</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-79" class="exercise"><strong>Exercise 3.18  </strong></span>
Sands dumping from a truck to the ground at a constant rate 5 m<span class="math inline">\(^3\)</span>/s is creating a circular cone. Find a relation between the rate of growth of the radius of the base and the rate of growth of the height of cone, when the the base is 6 m and the heigh is 4 m.</p>
</div>

</div>
<div id="linearizations" class="section level2">
<h2><span class="header-section-number">3.7</span> Linearizations</h2>
<p>Let <span class="math inline">\(f\)</span> be the function differentiable at <span class="math inline">\(x = a\)</span>. The <strong>linearization</strong> of <span class="math inline">\(f\)</span> at <span class="math inline">\(x = a\)</span> is defined to be the function <span class="math inline">\(L(x)=f&#39;(a)(x-a)+f(a)\)</span>. For any value <span class="math inline">\(b\)</span> near <span class="math inline">\(a\)</span>, the function value <span class="math inline">\(f(b)\)</span> is approximately the same as <span class="math inline">\(L(b)\)</span>. This method is called <strong>linear approximation</strong>. The tangent line approximation is fundamental to almost every application of the derivative.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-80" class="example"><strong>Example 3.9  </strong></span>
Find the linearization <span class="math inline">\(L(x)\)</span> of the function <span class="math inline">\(f(x) = \sqrt[3](x+7)\)</span> at <span class="math inline">\(x=1\)</span> and use this linearization to estimate <span class="math inline">\(f(0.99)\)</span>. How large is the error?</p>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> 
We first find the slope fr the linearization which is the derivative <span class="math inline">\(f&#39;(1)\)</span>.</p>
<pre><code>f:=x-&gt;surd(x+7, 3); # or f:=x-&gt;(x+7)^(1/3)
m:=simplify(D(f)(1)); # this is the slope (simplified).</code></pre>
<p>Now we define the linearization <span class="math inline">\(L(x)\)</span> and estimate <span class="math inline">\(f(0.99)\)</span> using <span class="math inline">\(L(0.99)\)</span>.</p>
<pre><code>L:=x-&gt;m*(x-1)+f(1);
L(0.99);</code></pre>
<p>The error may be calculated based on the output of the follow command.</p>
<pre><code>f_L:=f(0.99)-L(0.99);</code></pre>
<p>The results shows that the linear approximation is slightly over estimated with an error less than <span class="math inline">\(4\times 10^{-7}\)</span>.</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-82" class="exercise"><strong>Exercise 3.19  </strong></span>
Find the linear approximation <span class="math inline">\(L(x)\)</span> of the function <span class="math inline">\(f(x) = \frac{\sqrt{x}}{x+1}\)</span> at <span class="math inline">\(x = 1\)</span>. Use this linearization to approximate <span class="math inline">\(f(1.02)\)</span>.</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-83" class="exercise"><strong>Exercise 3.20  </strong></span>
Find the linear approximation <span class="math inline">\(L(x)\)</span> of the function <span class="math inline">\(f(x) = \cos(2x)\)</span> at <span class="math inline">\(x = 0\)</span>. Use this linearization to approximate <span class="math inline">\(f(0.1)\)</span>.</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-84" class="exercise"><strong>Exercise 3.21  </strong></span>
Find the linear approximation <span class="math inline">\(L(x)\)</span> of the function <span class="math inline">\(f(x) = \sqrt{x^2+5}\)</span> at <span class="math inline">\(x = 2\)</span>. Use this linearization to approximate <span class="math inline">\(f(2.03)\)</span>.</p>
</div>

</div>
<div id="newtons-method" class="section level2">
<h2><span class="header-section-number">3.8</span> Newton’s Method</h2>
<p>In science and engineering, many problems may be eventually reduced to nonlinear equations which likely has no algebraic (analytic) solution. In such a situation, numerical solutions are hoped for applications. We’ve seen a method to find a numerical solution using the intermediate value theorem. However, it is not very effective. Using linearization, a root-finding algorithm was developed by Newton and other mathematicians. The idea is to use the <span class="math inline">\(x\)</span>-coordinates of tangent lines to approximate a root of an equation. Let’s see an example first using the Maple command <code>NewtonsMethod(function, starting point, options)</code> which is again supported by the subpackage <code>Student[Calculus1]</code>.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-85" class="example"><strong>Example 3.10  </strong></span>
Starting at <span class="math inline">\(x=-1.5\)</span>, obtain a solution of <span class="math inline">\(\sin x-\frac{x}{2}=0\)</span> by Newton’s method.</p>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> 
First load <code>Student[Calculus1]</code> use <code>with()</code>.</p>
<pre><code>with(Student[Calculus1])</code></pre>
<p>Now apply the <code>NewtonsMethod command</code></p>
<pre><code>NewtonsMethod(sin(x)-x/2, x=-1.5)</code></pre>
<p>To see the graph, you may add the option <code>output=plot</code>.</p>
<pre><code>NewtonsMethod(sin(x)-x/2, x=-1.5, showroot=true, output=plot)</code></pre>
</div>

<p>How does Newton’s methods work? It’s an iteration process. Consider the equation <span class="math inline">\(f(x)=0\)</span>. Suppose <span class="math inline">\(f\)</span> is differentiable. To find a solution, we pick an initial value <span class="math inline">\(x_0\)</span> first. The <span class="math inline">\(x\)</span>-value <span class="math inline">\(x_1\)</span> of the <span class="math inline">\(x\)</span>-intercept of the linearization <span class="math inline">\(L_0(x)=f&#39;(x_0)(x-x_0)+f(x_0)\)</span> should produce a value that is closer. The value <span class="math inline">\(x_1\)</span> is given by the formula
<span class="math display">\[
x_1=x_0-\frac{f(x_0)}{f&#39;(x_0)}.
\]</span>
Iteratedly applying the above idea, we get the iteration formula
<span class="math display">\[
x_{n}=x_{n-1}-\frac{f(x_{n-1})}{f&#39;(x_{n-1})}.
\]</span></p>

<div class="remark">
<p> <span class="remark"><em>Remark. </em></span> 
How many times should be iterated? It depends on the sizes of acceptable errors and a maximum number of iteration.</p>
<p>If the <span class="math inline">\(x\)</span>-values produced from two successive iterates is sufficiently small, say <span class="math inline">\(|x_n-x_{n-1}|&lt;e_1\)</span>, and the function value at <span class="math inline">\(x=x_n\)</span> is sufficiently small, say <span class="math inline">\(f(x_n)&lt;e_2\)</span>, where <span class="math inline">\(e_1\)</span> and <span class="math inline">\(e_2\)</span> are acceptable errors, then we may say <span class="math inline">\(f(x)=0\)</span> has a solution at <span class="math inline">\(x=x_n\)</span>.</p>
<p>If after iterated a maximum number of times and a solution was not found, then we may have to change the initial value or using other methods.</p>
<p>If it happens that <span class="math inline">\(f&#39;(x_n) = 0\)</span>, then the iteration process fails.</p>
<p>The above algorithm may be realized using the following Maple codes.</p>
<pre><code>tol := 10^(-3);
N := 100;
f := x -&gt; sin(x) - 1/2*x;
m := D(f);
newton := x -&gt; evalf(x - f(x)/m(x)); # Newton&#39;s formula
x := -1.5;

for i to N do
  x := newton(x);
  if abs(x - newton(x)) &lt; tol and abs(f(x)) &lt; tol then
    break;
  eli i = N then
    error &quot;Newton&#39;s method did not converge&quot;;
  end if;
end do;

print(x);</code></pre>
<p>If you don’t want to check the size of error, the code can be simplified using the composite symbol <code>@</code> in Maple.</p>
<pre><code>restart;
f := x -&gt; sin(x) - 1/2*x;
m := D(f);
newton := x -&gt; evalf(x - f(x)/m(x));
N:=100
x[N]:=evalf((newton@@N)(-1.5)); # @@N means that newton compose with itself N times.</code></pre>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-88" class="exercise"><strong>Exercise 3.22  </strong></span>
Using Newton’s Method to find solutions of the polynomial equation <span class="math inline">\(x^3-x^2+1=0\)</span>.</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-89" class="exercise"><strong>Exercise 3.23  </strong></span>
Using Newton’s Method to find solutions of the equation <span class="math inline">\(\cos x=\frac{x}{2}\)</span>.</p>
</div>


<div class="exercise">
<p><span id="exr:unnamed-chunk-90" class="exercise"><strong>Exercise 3.24  </strong></span>
Using Newton’s Method to find the solution of the equation <span class="math inline">\(\tan x-2x=0\)</span> in the interval <span class="math inline">\([1, 2]\)</span>. Among 1 and 2,which is a better initial value? Why?</p>
</div>


</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="limits.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="application-of-differentiation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["maple-notes.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
